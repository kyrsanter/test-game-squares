(this["webpackJsonpgame-test"]=this["webpackJsonpgame-test"]||[]).push([[0],{200:function(e,t,n){},201:function(e,t,n){},202:function(e,t,n){},204:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(42),l=n.n(c),o=(n(97),n(10)),i=n(15),s=n(17),u=n(16),m=n(18),d=(n(98),r.a.createContext()),f=d.Provider,p=d.Consumer,g=function(e){return function(t){return r.a.createElement(p,null,(function(n){return r.a.createElement(e,Object.assign({},t,{service:n}))}))}},h=n(7),E=n(206),b=n(205),v=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{className:"control-panel",onSubmit:this.props.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement(E.a,{required:!0,className:"custom-select",name:"difficult",component:"select"},r.a.createElement("option",{disabled:!0},"Choise one"),r.a.createElement("option",{value:"easyMode"},"Ease"),r.a.createElement("option",{value:"normalMode"},"Normal"),r.a.createElement("option",{value:"hardMode"},"Hard"))),r.a.createElement("div",{className:"col"},r.a.createElement(E.a,{type:"text",name:"name",className:"form-control",placeholder:"Put your name",component:"input"})),r.a.createElement("div",{className:"col"},r.a.createElement("button",{type:"sudmit",className:"btn btn-secondary"},this.props.started?"Play again":"Play"))))}}]),t}(r.a.Component),y=Object(b.a)({form:"settings"})(v),O=(n(200),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).makeSettings=function(e,t){var a=[],r=n.selfRandom(e,t);n.props.onGotRndNums(r);for(var c=0;c<r.length;c++)a[c]={id:c,canBeCliked:!1,cliked:!1,blue:!1,green:!1,red:!1};n.props.onBlocksGet(a)},n.selfRandom=function(e,t){for(var n=[];n.length<t;){var a=Math.floor(Math.random()*(t-e+1))+e;n.includes(a)||n.push(a)}return n},n.submit=function(e){var t=e.difficult,a=e.name;if(void 0!==t&&void 0!==a){var r=n.props,c=r.service,l=r.onSettigns;(0,r.onLoadingStarted)(),c.getDifficultySettings().then((function(e){for(var a in e)if(a===t){var r=Math.pow(e[a].field,2);n.makeSettings(0,r),l(e[a]),n.props.onGameStarted()}}))}else alert("You must choose a difficulty level and put your name")},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(y,{onSubmit:this.submit,started:this.props.started})}}]),t}(r.a.Component)),j=g(Object(h.b)((function(e){return{started:e.main.gameStarted}}),(function(e){return{onGameStarted:function(){return e({type:"START_GAME"})},onSettigns:function(t){return e(function(e){return{type:"GOT_GAME_SETTINGS",payload:e}}(t))},onLoadingStarted:function(){return e({type:"FETCH_LOADING"})},onBlocksGet:function(t){return e(function(e){return{type:"GOT_BLOCKS",payload:e}}(t))},onGotRndNums:function(t){return e(function(e){return{type:"GOT_RND_NUMS",payload:e}}(t))}}}))(O)),N=(n(201),function(){return r.a.createElement("div",{className:"preloader"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"loadingio-spinner-double-ring-1vus6d2jg24"},r.a.createElement("div",{className:"ldio-yualpvbqphi"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null,r.a.createElement("div",null)),r.a.createElement("div",null,r.a.createElement("div",null))))))}),S=n(12),k=n(90),G=(n(202),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).start=function(){var e=n.props,t=e.delay,a=e.blocks,r=e.hasWinner;new Promise((function(e){n.makeBlue(),setTimeout(e,t)})).then((function(){n.makeRed(),n.counter<a.length&&!r&&n.start()}))},n.makeRed=function(){var e=n.props,t=e.rndNums,a=e.blocks;if(!e.hasWinner){var r=a.filter((function(e){return e.id===t[n.counter]})),c=Object(k.a)(r,1);Object(S.a)({},c[0]).green||n.props.onRed(t[n.counter]),n.counter++}},n.makeBlue=function(){var e=n.props,t=e.rndNums,a=e.blocks,r=e.hasWinner;n.counter<a.length&&!r&&n.props.onBlue(t[n.counter])},n.toDoGreen=function(e){var t=n.props,a=t.blocks,r=t.onGreen;a.find((function(t){return t.id===e})).canBeCliked&&r(e)},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.counter=0,this.start()}},{key:"render",value:function(){var e=this,t=this.props,n=t.blocks,a=t.size/t.field;return r.a.createElement(r.a.Fragment,null,n.map((function(t){return r.a.createElement("div",{style:{width:"".concat(a,"px"),height:"".concat(a,"px"),background:"".concat(t.blue?"blue":t.red?"red":t.green?"green":"none")},key:t.id,onClick:function(){return e.toDoGreen(t.id)},className:"game-block"},null)})))}}]),t}(r.a.Component)),_=Object(h.b)((function(e){var t=e.main;return{hasWinner:t.win,delay:t.gameSettings.delay,field:t.gameSettings.field,blocks:t.gameSettings.gamePlay,rndNums:t.rndNums}}),(function(e){return{onRed:function(t){return e(function(e){return{type:"MAKE_RED",payload:e}}(t))},onBlue:function(t){return e(function(e){return{type:"MAKE_BLUE",payload:e}}(t))},onGreen:function(t){return e(function(e){return{type:"MAKE_GREEN",payload:e}}(t))}}}))(G),w=Object(h.b)((function(e){var t=e.main;return{field:t.gameSettings.field,pc:t.score.pc,user:t.score.user}}),(function(e){return{onEndGame:function(){return e({type:"END_GAME"})}}}))((function(e){var t=e.pc,n=e.user,a=e.field,c=Math.pow(a,2);return t>c/2+1?(e.onEndGame(),r.a.createElement("div",{className:"score-table"},r.a.createElement("h1",null,"PC WIN!!! With ",t," scores"))):n>c/2+1?(e.onEndGame(),r.a.createElement("div",{className:"score-table"},r.a.createElement("h1",null,"User WIN!!! With ",n," scores"))):r.a.createElement("div",{className:"score-table"},r.a.createElement("div",null,"User scores: ",n),r.a.createElement("div",null,"PC scores: ",t))})),M=function(){return r.a.createElement("section",{className:"mb-2"},r.a.createElement("ol",null,r.a.createElement("li",null,"User set game difficulty and name"),r.a.createElement("li",null,"Press PLAY"),r.a.createElement("li",null,"At a specified time interval a random square on the field is highlighted in blue"),r.a.createElement("li",null,"If the user managed to click on the square during this time - he turns green, the player gets a point and the field changes color to green"),r.a.createElement("li",null,"If not, the field turns red and the point goes to the computer"),r.a.createElement("li",null,"When a player or computer paints >50% of all possible squares in his color - he becomes the winner")))},A=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).sizeRef=r.a.createRef(),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.size=this.sizeRef.current.offsetWidth}},{key:"render",value:function(){return r.a.createElement("section",{className:"game"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6"},r.a.createElement(j,null),this.props.started?null:r.a.createElement(M,null)),r.a.createElement("div",{className:"col-lg-6"},r.a.createElement("section",{ref:this.sizeRef,className:"game"},this.props.loading?r.a.createElement(N,null):this.props.started?r.a.createElement(_,{size:this.size}):null))),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-lg-4"},this.props.started?r.a.createElement(w,null):null))))}}]),t}(r.a.Component),C=Object(h.b)((function(e){var t=e.main;return{loading:t.loading,started:t.gameStarted}}),(function(e){return{onLoadingStart:function(){return e({type:"FETCH_LOADING"})}}}))(A),R=n(27),P=n.n(R),T=n(5),D=n(46),B=n(9),x={gameStarted:!1,loading:!1,gameSettings:{field:null,delay:null,gamePlay:null},score:{pc:0,user:0},rndNums:null,win:!1},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_LOADING":return Object(B.a)({},e,{loading:!0});case"FETCH_FORM_DATA":return Object(B.a)({},e,{formData:t.payload});case"START_GAME":return Object(B.a)({},e,{loading:!1,gameStarted:!0});case"END_GAME":return Object(B.a)({},e,{win:!0});case"GOT_GAME_SETTINGS":var n=t.payload,a=n.field,r=n.delay;return Object(B.a)({},e,{gameSettings:{field:a,delay:r,gamePlay:e.gameSettings.gamePlay}});case"GOT_BLOCKS":return Object(B.a)({},e,{gameSettings:{field:e.gameSettings.field,delay:e.gameSettings.delay,gamePlay:t.payload}});case"GOT_RND_NUMS":return Object(B.a)({},e,{rndNums:t.payload});case"MAKE_BLUE":var c=t.payload,l=e.gameSettings.gamePlay.map((function(e){return e.id===c?(e.canBeCliked=!0,e.blue=!0,e):e}));return Object(B.a)({},e,{gameSettings:Object(B.a)({},e.gameSettings,{gamePlay:Object(D.a)(l)})});case"MAKE_RED":var o=t.payload,i=e.gameSettings.gamePlay.map((function(e){return e.id!==o||e.green?e:(e.canBeCliked=!1,e.blue=!1,e.red=!0,e)}));return Object(B.a)({},e,{gameSettings:Object(B.a)({},e.gameSettings,{gamePlay:Object(D.a)(i)}),score:{user:e.score.user,pc:e.score.pc+1}});case"MAKE_GREEN":var s=t.payload,u=e.gameSettings.gamePlay.map((function(e){return e.id===s?(e.canBeCliked=!1,e.blue=!1,e.green=!0,e):e}));return Object(B.a)({},e,{gameSettings:Object(B.a)({},e.gameSettings,{gamePlay:Object(D.a)(u)}),score:{user:e.score.user+1,pc:e.score.pc}});default:return e}},I=n(207),W=Object(T.b)({main:L,form:I.a}),U=Object(T.c)(W),K=n(89),z=n.n(K),F=function(){return r.a.createElement("section",{className:"error-block"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-6 text-center"},r.a.createElement("img",{src:z.a,alt:"error"}),r.a.createElement("h1",null,"\u0423\u043f\u0441, \u0447\u0442\u043e \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!"),r.a.createElement("h2",null,"\u041a\u043e\u043d\u0433\u0440\u0435\u0441\u0441 \u0421\u0428\u0410 \u0443\u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430\u0434 \u0443\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u0435\u043c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b")))))},q=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={hasError:!1},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(F,null):this.props.children}}]),t}(r.a.Component),H=new function e(){var t=this;Object(o.a)(this,e),this._baseUrl="https://starnavi-frontend-test-task.herokuapp.com/",this.getResources=function(e){var n;return P.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P.a.awrap(fetch("".concat(t._baseUrl).concat(e)));case 2:if(!(n=a.sent).ok){a.next=9;break}return a.next=6,P.a.awrap(n.json());case 6:return a.abrupt("return",a.sent);case 9:throw new Error("\u0423\u043f\u0441, \u0441 \u0442\u0432\u043e\u0438\u043c \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u043e\u043c \u0447\u0442\u043e \u0442\u043e \u043d\u0435 \u0442\u043e!!!");case 10:case"end":return a.stop()}}))},this.getDifficultySettings=function(){var e;return P.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P.a.awrap(t.getResources("game-settings"));case 2:return e=n.sent,n.abrupt("return",e);case 4:case"end":return n.stop()}}))}},J=r.a.createElement(h.a,{store:U},r.a.createElement(f,{value:H},r.a.createElement(q,null,r.a.createElement(C,null))));l.a.render(J,document.getElementById("root"))},89:function(e,t,n){e.exports=n.p+"static/media/error.500dce70.png"},92:function(e,t,n){e.exports=n(204)},97:function(e,t,n){},98:function(e,t,n){}},[[92,1,2]]]);
//# sourceMappingURL=main.76f3a67a.chunk.js.map